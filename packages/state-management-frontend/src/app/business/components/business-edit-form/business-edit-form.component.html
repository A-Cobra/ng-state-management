<div class="form__main">
  <h1>Business Edit Form</h1>
  <div *ngIf="id">{{ id }}</div>
  <form class="form" [formGroup]="businessFormEdit">
    <div class="left-column">
      <div class="business-img">
        <clapp-image-display
          *ngIf="businessData && businessData.imgUrl; else defaultImage"
          [src]="businessData.imgUrl"
          [alt]="businessData.businessName + '.png'"
          type="avatar"
          size="large"
        >
        </clapp-image-display>
        <ng-template #defaultImage>
          <clapp-image-display
            src="../../../../assets/template-image.png"
            alt="placeholder.png"
            type="avatar"
            size="large"
          ></clapp-image-display>
        </ng-template>
      </div>

      <div *ngIf="businessData">
        Total branches: {{ businessData.totalBranches }}
      </div>

      <state-management-app-reactive-form-control-text-input
        [parentForm]="businessFormEdit"
        controlName="contactPhoneNumber"
        displayText="Please enter the contact number"
        label="Contact Number"
        stateManagementAppPhoneNumber
        [reactiveFormControl]="businessFormEdit.controls['contactPhoneNumber']"
      ></state-management-app-reactive-form-control-text-input>

      <state-management-app-reactive-form-control-text-input
        [parentForm]="businessFormEdit"
        controlName="contactEmail"
        displayText="Please enter the contact email"
        label="Contact Email"
      ></state-management-app-reactive-form-control-text-input>
    </div>

    <div class="right-column">
      <state-management-app-reactive-form-control-text-input
        [parentForm]="businessFormEdit"
        displayText="Please enter the display name"
        label="Display Name"
      ></state-management-app-reactive-form-control-text-input>

      <state-management-app-reactive-form-control-text-input
        [parentForm]="businessFormEdit"
        controlName="businessName"
        displayText="Please enter the business name"
        label="Business Name"
      ></state-management-app-reactive-form-control-text-input>

      <div class="form__group">
        <clapp-select
          [formControl]="businessFormEdit.controls['businessClassification']"
          [selectedValue]="'none'"
          label="Business Classification"
          [borderless]="false"
          [displayLabel]="false"
          inputName="businessClassification"
          [pagination]="false"
          placeholder="Classification *"
          [hasFilter]="true"
        >
          <clapp-search
            (keyup)="onWriteValue($event)"
            (valueDeleted)="onValueDeleted()"
            [formControl]="businessFormEdit.controls['businessClassification']"
          ></clapp-search>
          <clapp-select-option
            *ngFor="let classification of mockClassificationList"
            [key]="classification.key"
            [value]="classification.key"
          ></clapp-select-option>
        </clapp-select>
        <!-- Error Text  -->
        <div
          class="error"
          *ngIf="
            !!businessFormEdit.controls['businessClassification'].errors &&
            businessFormEdit.controls['businessClassification'].touched
          "
        >
          <clapp-helper-text
            [textState]="
              businessFormEdit.controls['businessClassification'].disabled
                ? 'disabled'
                : 'error'
            "
          >
            {{
              businessFormEdit.controls['businessClassification'].errors
                | fullErrorName
            }}
          </clapp-helper-text>
        </div>
      </div>

      <state-management-app-reactive-form-control-text-input
        [parentForm]="businessFormEdit"
        controlName="contactAddress"
        displayText="Please enter the contact address"
        label="Contact Address"
      ></state-management-app-reactive-form-control-text-input>

      <div class="coordinates">
        <state-management-app-reactive-form-control-text-input
          [parentForm]="businessFormEdit"
          controlName="longitude"
          displayText="Please enter the longitude"
          label="Longitude"
          stateManagementAppFloatNumberOrNumberRange
          [reactiveFormControl]="businessFormEdit.controls['longitude']"
          [maxValue]="180"
          [minValue]="-180"
        ></state-management-app-reactive-form-control-text-input>

        <state-management-app-reactive-form-control-text-input
          [parentForm]="businessFormEdit"
          controlName="latitude"
          displayText="Please enter the latitude"
          label="Latitude"
          stateManagementAppFloatNumberOrNumberRange
          [reactiveFormControl]="businessFormEdit.controls['latitude']"
          [maxValue]="90"
          [minValue]="-90"
        ></state-management-app-reactive-form-control-text-input>
      </div>
    </div>
  </form>

  <div class="buttons">
    <div class="buttons__left">
      <clapp-button
        color="secondary"
        plusIcon="ri-arrow-left-s-line"
        (click)="onGoBack()"
        >Go back</clapp-button
      >
    </div>
    <div class="buttons__right" *ngIf="businessData">
      <clapp-button
        *ngIf="!editing; else saveButton"
        (click)="onEditClick()"
        color="tertiary-white"
        size="small"
        type="button"
        plusIcon="ri-edit-2-fill"
      >
        Edit
      </clapp-button>
      <ng-template #saveButton>
        <clapp-button
          (click)="onSaveClick()"
          color="secondary"
          size="small"
          type="button"
          plusIcon="ri-save-line"
          [disabled]="businessFormEdit.invalid"
        >
          Save
        </clapp-button>
      </ng-template>
      <clapp-button
        color="primary"
        size="small"
        type="button"
        plusIcon="ri-delete-bin-2-fill"
      >
        Delete
      </clapp-button>
    </div>
  </div>
</div>

<pre>{{ businessFormEdit.value | json }}</pre>
